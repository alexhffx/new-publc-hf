---
/**
 * Hedge Ratio donut card — small card overlapping the exposure card.
 * SVG donut animates stroke on load.
 */
interface Props {
  percentage?: number;
  currency?: string;
}

const {
  percentage = 72,
  currency = 'EUR/GBP',
} = Astro.props;

// SVG donut math — radius 40, circumference ≈ 251.33
const circumference = 251.33;
const filled = (percentage / 100) * circumference;
---

<div class="hedge-card">
  <span class="hedge-card__label">Hedge Ratio</span>

  <div class="hedge-card__chart">
    <svg viewBox="0 0 100 100" class="hedge-card__donut">
      <!-- Background ring -->
      <circle cx="50" cy="50" r="40" fill="none" stroke="#E8F8F0" stroke-width="8" />
      <!-- Filled ring -->
      <circle
        cx="50" cy="50" r="40"
        fill="none"
        stroke="#038458"
        stroke-width="8"
        stroke-linecap="round"
        stroke-dasharray={`${filled} ${circumference}`}
        transform="rotate(-90 50 50)"
        class="hedge-card__ring"
      />
    </svg>
    <span class="hedge-card__pct">{percentage}%</span>
  </div>

  <p class="hedge-card__currency">{currency}</p>
  <p class="hedge-card__disclaimer">Sample data</p>
</div>

<style>
  .hedge-card {
    width: 200px;
    padding: 1.25rem;
    text-align: center;
  }

  .hedge-card__label {
    font-size: 0.6875rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: #6B7280;
  }

  .hedge-card__chart {
    position: relative;
    width: 96px;
    height: 96px;
    margin: 0.75rem auto 0.5rem;
  }

  .hedge-card__donut {
    width: 100%;
    height: 100%;
  }

  .hedge-card__ring {
    animation: donutFill 1.5s ease both;
    animation-delay: 0.5s;
  }

  .hedge-card__pct {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    font-weight: 700;
    color: #343A40;
  }

  .hedge-card__currency {
    font-size: 0.75rem;
    font-weight: 500;
    color: #4B5563;
  }

  .hedge-card__disclaimer {
    font-size: 0.625rem;
    color: #9CA3AF;
    margin-top: 0.375rem;
    font-style: italic;
  }

  @keyframes donutFill {
    from {
      stroke-dasharray: 0 251.33;
    }
  }
</style>
