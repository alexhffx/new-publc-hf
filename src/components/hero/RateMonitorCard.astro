---
/**
 * Rate Monitor card — shows a currency pair with sparkline and lock-rate CTA.
 */
interface Props {
  pair?: string;
  currentRate?: string;
  changeToday?: string;
  favourable?: boolean;
  lockRateHref?: string;
}

const {
  pair = 'GBP / EUR',
  currentRate = '1.1842',
  changeToday = '+0.32%',
  favourable = true,
  lockRateHref = 'https://app.hedgeflows.com',
} = Astro.props;
---

<div class="rate-card">
  <div class="rate-card__header">
    <span class="rate-card__pair">{pair}</span>
    <span class:list={['rate-card__change', favourable ? 'rate-card__change--up' : 'rate-card__change--down']}>
      {changeToday}
    </span>
  </div>

  <!-- Mini SVG sparkline (illustrative 7-day) -->
  <svg class="rate-card__sparkline" viewBox="0 0 240 60" preserveAspectRatio="none">
    <defs>
      <linearGradient id="sparkGrad" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#038458" stop-opacity="0.15" />
        <stop offset="100%" stop-color="#038458" stop-opacity="0" />
      </linearGradient>
    </defs>
    <!-- Area fill -->
    <path
      d="M0,45 L34,38 L69,42 L103,30 L137,25 L171,28 L206,15 L240,18 L240,60 L0,60Z"
      fill="url(#sparkGrad)"
    />
    <!-- Line -->
    <path
      d="M0,45 L34,38 L69,42 L103,30 L137,25 L171,28 L206,15 L240,18"
      fill="none"
      stroke="#038458"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="rate-card__line"
    />
  </svg>

  <div class="rate-card__bottom">
    <div>
      <p class="rate-card__rate">{currentRate}</p>
      <p class="rate-card__disclaimer">Sample data · 7-day</p>
    </div>
    <a href={lockRateHref} class="rate-card__cta" target="_blank" rel="noopener noreferrer">
      Lock rate
    </a>
  </div>
</div>

<style>
  .rate-card {
    width: 280px;
    padding: 1.25rem 1.5rem;
  }

  .rate-card__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.75rem;
  }

  .rate-card__pair {
    font-size: 0.8125rem;
    font-weight: 600;
    color: #343A40;
  }

  .rate-card__change {
    font-size: 0.6875rem;
    font-weight: 600;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
  }

  .rate-card__change--up {
    background: #ECFDF5;
    color: #038458;
  }

  .rate-card__change--down {
    background: #FEF2F2;
    color: #DC2626;
  }

  .rate-card__sparkline {
    width: 100%;
    height: 48px;
    margin-bottom: 0.75rem;
  }

  .rate-card__line {
    stroke-dasharray: 400;
    stroke-dashoffset: 400;
    animation: drawLine 1.8s ease forwards;
    animation-delay: 0.8s;
  }

  .rate-card__bottom {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
  }

  .rate-card__rate {
    font-size: 1.5rem;
    font-weight: 700;
    color: #343A40;
    line-height: 1.2;
  }

  .rate-card__disclaimer {
    font-size: 0.625rem;
    color: #9CA3AF;
    font-style: italic;
    margin-top: 0.125rem;
  }

  .rate-card__cta {
    font-size: 0.75rem;
    font-weight: 600;
    color: white;
    background: #038458;
    padding: 0.375rem 0.875rem;
    border-radius: 9999px;
    text-decoration: none;
    transition: background 0.2s ease;
    white-space: nowrap;
  }

  .rate-card__cta:hover {
    background: #027A53;
  }

  @keyframes drawLine {
    to { stroke-dashoffset: 0; }
  }
</style>
